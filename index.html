<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>a.lazyflower ä¸€æœµæ‡¶æ‡¶èŠ±ğŸŒ¸</title>
    <!-- å¼•å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Fonts - Noto Sans TC for better Chinese display and Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- å¼•å…¥ Instagram åµŒå…¥è…³æœ¬ (Async/éåŒæ­¥è¼‰å…¥) -->
    <script async src="//www.instagram.com/embed.js"></script>
    
    <style>
        /* è¨­ç½®åŸºæœ¬å­—é«”å’ŒèƒŒæ™¯ï¼Œä½¿ç”¨ Noto Sans TC å„ªå…ˆ */
        body {
            font-family: 'Noto Sans TC', 'Inter', sans-serif;
            background-color: #fcfcfc; /* æ¥è¿‘ç´”ç™½çš„èƒŒæ™¯ */
        }
        .text-pink{
            color: #ffa4d1;
        }
        .bg-blue{
            background-color: #32a9df;
        }
        .bg-blue:hover{
            background-color: rgb(27, 128, 175);
        }
        /* é‡å°è²¼æ–‡å¡ç‰‡è¨­è¨ˆæ›´è±å¯Œçš„é™°å½±èˆ‡äº’å‹•æ•ˆæœ */
        .post-card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            background-color: #ffffff;
            border: 1px solid #f0f0f0;
        }
        .post-card:hover {
            transform: translateY(-5px) rotate(0.5deg); /* è¼•å¾®ä¸Šæµ®å’Œæ—‹è½‰å¢åŠ è¶£å‘³æ€§ */
            /* ä½¿ç”¨ç²‰è‰²èª¿çš„é™°å½± */
            box-shadow: 0 15px 25px -5px rgba(236, 72, 153, 0.2); 
        }
        /* å´é‚Šå°èˆªæ¬„å›ºå®š */
        #sidebar {
            width: 16rem; /* 256px */
            transition: transform 0.3s ease-in-out;
            max-height: calc(100vh - 8rem); /* è®“å´é‚Šæ¬„å¯æ²å‹• */
        }
        /* æ²è»¸ç¾åŒ– (åƒ…é‡å°æ”¯æ´çš„ç€è¦½å™¨) */
        #sidebar::-webkit-scrollbar {
            width: 6px;
        }
        #sidebar::-webkit-scrollbar-thumb {
            background-color: #f9a8d4; /* æ·ºç²‰è‰²æ²è»¸ */
            border-radius: 3px;
        }
        /* IG åµŒå…¥è²¼æ–‡å®¹å™¨æ¨£å¼ */
        .ig-embed-container {
            width: 100%;
            min-width: 0;
            overflow: hidden;
        }
        .ig-embed-container .instagram-media {
            width: 100% !important;
            max-width: 100% !important;
            min-width: 0 !important;
            margin: 0 !important;
            padding: 0 !important;
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- é ‚éƒ¨å°èˆªèˆ‡æ¨™é¡Œ (Sticky Header) -->
    <header class="sticky top-0 bg-white shadow-xl z-20">
        <div class="max-w-7xl mx-auto p-4 flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
            <!-- ç²‰è‰²ä¸»é¡Œæ¨™é¡Œ -->
            <h1 class="text-xl font-extrabold text-pink flex items-center">
                a.lazyflower<br>ä¸€æœµæ‡¶æ‡¶èŠ±ğŸŒ¸ å°ä¸­ï½œç¾é£Ÿï½œç”Ÿæ´»
            </h1>
            
            <!-- æœå°‹æ¬„ (ä½¿ç”¨è—è‰²é‚Šæ¡†è¼”åŠ©) -->
            <div class="w-full sm:w-96 relative">
                <input 
                    type="text" 
                    id="search-input" 
                    placeholder="ğŸ” æœå°‹å€åŸŸã€åº—åæˆ–é—œéµå­—..." 
                    class="w-full py-2.5 pl-5 pr-10 border-2 border-blue-300 rounded-full shadow-md focus:outline-none focus:ring-4 focus:ring-blue-100 transition duration-200"
                    oninput="filterPosts(this.value)"
                >
            </div>
        </div>
        
        <!-- æ‰‹æ©Ÿç‰ˆåˆ†é¡å°è¦½ (æ°´å¹³æ»¾å‹•) -->
        <div class="lg:hidden border-t border-slate-200 bg-white">
            <div class="max-w-7xl mx-auto px-4 py-3">
                <h3 class="text-sm font-bold mb-2 text-blue-500">åˆ†é¡å°è¦½</h3>
                <div class="overflow-x-auto">
                    <ul id="mobile-nav-list" class="flex space-x-3 pb-2">
                        <!-- å€åŸŸåˆ—è¡¨å°‡ç”± JS æ¸²æŸ“ -->
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <!-- ä¸»è¦ä½ˆå±€ï¼šå´é‚Šæ¬„ + å…§å®¹ -->
    <div class="max-w-7xl mx-auto flex">
        
        <!-- å´é‚Šå€åŸŸå°èˆªæ¬„ (Sticky Sidebar) -->
        <nav id="sidebar" class="hidden lg:block sticky top-32 py-8 pr-6 border-r border-slate-100 overflow-y-auto">
            <!-- å°èˆªæ¨™é¡Œä½¿ç”¨è—è‰² -->
            <h3 class="text-lg font-bold mb-4 text-blue-500 border-b pb-2 border-blue-100">åˆ†é¡å°è¦½</h3>
            <ul id="city-nav-list" class="space-y-2">
                <!-- å€åŸŸåˆ—è¡¨å°‡ç”± JS æ¸²æŸ“ -->
            </ul>
        </nav>

        <!-- ä¸»è¦æ–‡ç« å…§å®¹å€å¡Š -->
        <main class="flex-1 p-4 sm:p-6 lg:p-10">
            <!-- æ–‡ç« å®¹å™¨ï¼Œå°‡ç”± JavaScript æ¸²æŸ“å…§å®¹ -->
            <div id="posts-container" class="space-y-16">
                <!-- é€™è£¡å°‡è¼‰å…¥æ‰€æœ‰åŸå¸‚åˆ†çµ„å’Œæ–‡ç«  -->
            </div>

            <!-- æœå°‹çµæœç©ºç™½æç¤º -->
            <div id="no-results" class="text-center py-20 hidden bg-slate-50 rounded-xl mt-10">
                <p class="text-2xl font-semibold text-slate-500 mb-2">
                    ğŸ˜… æ‰¾ä¸åˆ°çµæœ
                </p>
                <p class="text-lg text-slate-400">
                    æŠ±æ­‰ï¼æ‰¾ä¸åˆ°ç¬¦åˆ <span id="search-query-display" class="font-bold text-pink"></span> çš„é£Ÿè¨˜ã€‚
                </p>
                <p class="mt-4 text-slate-400">è«‹å˜—è©¦æ›´å¯¬æ³›çš„é—œéµå­—æˆ–æª¢æŸ¥æ‹¼å¯«ã€‚</p>
            </div>
        </main>
    </div>

    <!-- é è…³ -->
    <footer class="bg-slate-100 mt-12 py-8 text-center text-sm text-slate-500">
        <p>Copyright Â© 2025 a.lazyflower ä¸€æœµæ‡¶æ‡¶èŠ±ğŸŒ¸. All rights reserved.</p>
    </footer>

    <script>
        const POSTS_PER_LOAD = 6; // åˆå§‹æˆ–æ¯æ¬¡è¼‰å…¥çš„æ–‡ç« æ•¸é‡
        
        // å…¨å°å„ç¸£å¸‚åç¨±+è‹±æ–‡ï¼Œä»¥åŠç‰¹æ®Šåˆ†é¡
        const REGIONS = [
            'å°åŒ— Taipei', 'æ–°åŒ— New Taipei', 'æ¡ƒåœ’ Taoyuan', 
            'è‹—æ — Miaoli','å°ä¸­ Taichung', 'å½°åŒ– Changhua',
            'å—æŠ• Nantou', 'é›²æ— Yunlin', 'å˜‰ç¾© Chiayi', 
            'å°å— Tainan', 'é«˜é›„ Kaohsiung','å±æ± Pingtung', 'å®œè˜­ Yilan', 'èŠ±è“® Hualien', 
            'å°æ± Taitung', 'æ—¥æœ¬ Japan', 'é–‹ç®± Unboxing', 'æ—…éŠ Travel'
        ];

        /**
         * IG è²¼æ–‡è³‡æ–™é›†
         * æ ¼å¼èªªæ˜ï¼š
         * - region: æ‰€å±¬å€åŸŸï¼ˆå¿…é ˆå°æ‡‰ REGIONS ä¸­çš„å€¼ï¼‰
         * - permalink: IG è²¼æ–‡çš„å®Œæ•´ URLï¼ˆä¾‹å¦‚ï¼šhttps://www.instagram.com/reel/DII3CyjzZ4z/ï¼‰
         * - date: ç™¼æ–‡æ—¥æœŸï¼ˆæ ¼å¼ï¼š'YYYY-MM-DD'ï¼Œä¾‹å¦‚ï¼š'2025-01-15'ï¼‰
         * - content: è²¼æ–‡å…§å®¹ï¼ˆç”¨æ–¼æœå°‹å’Œé¡¯ç¤ºï¼‰
         * - map: åœ°åœ–é€£çµï¼ˆé¸å¡«ï¼Œä¾‹å¦‚ï¼šGoogle Maps URLï¼Œå¦‚æœä¸ç‚ºç©ºå‰‡æœƒé¡¯ç¤ºåœ°åœ–æŒ‰éˆ•ï¼‰
         * 
         * æ–°å¢è²¼æ–‡æ™‚ï¼Œåªéœ€åœ¨æ­¤é™£åˆ—ä¸­æ·»åŠ æ–°ç‰©ä»¶å³å¯
         * è²¼æ–‡æœƒè‡ªå‹•ä¾ç…§æ—¥æœŸæ–°åˆ°èˆŠæ’åº
         */
        const IG_POSTS = [
            {
                region: 'å°ä¸­ Taichung',
                permalink: 'https://www.instagram.com/reel/DII3CyjzZ4z/',
                date: '2025-04-07',
                map: 'https://maps.app.goo.gl/9mzVJmZKHpGjL77g8',
                content: `âœ¨ï¸#IKIGAIç‡’è‚‰å°ˆé–€åº—

ğŸ½ç¾åœ‹CHç¿¼æ¿ï¼$440
ç¾åœ‹ç¿¼æ¿ï¼†ç‰›èˆŒé›™æ‹¼ï¼$490
10%æœå‹™è²»å¦æ”¶

ğŸ¡åœ°å€ï¼šå°ä¸­å¸‚è¥¿å±¯å€æœå¯Œè·¯100è™Ÿ2æ¨“
ğŸ•‘ç‡Ÿæ¥­æ™‚é–“ï¼š11:00ï½22:00
â˜ï¸é›»è©±ï¼š04 2251 8677

âœï¸ä¸€å€‹äººåƒç‡’è‚‰
çˆ½åº¦ç«Ÿç„¶é€™éº¼é«˜â—ï¸
é„°è¿‘è€è™åŸè³¼ç‰©ä¸­å¿ƒ
åº—å…§ä¹¾æ·¨èˆ’é©ï¼Œæœå‹™ä¹Ÿå¾ˆå¥½ğŸ‘ğŸ»
ç™½é£¯ã€å‘³å™Œæ¹¯å¯ä»¥ç„¡é™çºŒ
ä¸éæˆ‘å…‰åƒå®Œæ•´ä»½å¥—é¤å°±å¥½æ’äº†ğŸ˜‚
ç¾åœ‹ç¿¼æ¿ï¼†ç‰›èˆŒé›™æ‹¼
è‚‰è »æ–°é®®çš„ğŸ¥©ğŸ¥“
å‘³å™Œæ¹¯è£¡é‚„ç™¼ç¾è›¤èœŠ*1
ç¾å‘³åˆå¯¦æƒ çš„ç‡’è‚‰
åˆ†äº«çµ¦å¤§å®¶ï½

#æ‡¶æ‡¶èŠ±åƒå°ä¸­ #å°ä¸­ç¾é£Ÿ #å°ä¸­ #taichung #å°ç£ç¾é£Ÿ #å°æ¹¾ #ã‚°ãƒ«ãƒ¡ #å°æ¹¾ã‚°ãƒ«ãƒ¡ #å°ä¸­æ™¯é» #å°ä¸­è¥¿å±¯ #è¥¿å±¯ç¾é£Ÿ #è€è™åŸ #ç§‹ç´…è°· #taiwan #ç‡’è‚‰ #yakiniku #ç„¼è‚‰ #å°ä¸­ç‡’è‚‰`
            },
            {
                region: 'å°åŒ— Taipei',
                permalink: 'https://www.instagram.com/reel/DI-5Yj7T21O/?utm_source=ig_web_copy_link&igsh=MzRlODBiNWFlZA==',
                date: '2025-01-18',
                content: 'å°åŒ—å’–å•¡å»³æ¨è–¦ï¼Œäº«å—åˆå¾Œç¾å¥½æ™‚å…‰'
            },
            {
                region: 'æ—¥æœ¬ Japan',
                permalink: 'https://www.instagram.com/p/DRR0BYYEw5G/?utm_source=ig_web_copy_link&igsh=MzRlODBiNWFlZA==',
                date: '2025-01-15',
                content: 'æ—¥æœ¬æ—…éŠåˆ†äº«ï¼Œç¾éº—çš„é¢¨æ™¯å’Œç¾é£Ÿ'
            }
        ];

        const postsContainer = document.getElementById('posts-container');
        const noResults = document.getElementById('no-results');
        const searchQueryDisplay = document.getElementById('search-query-display');
        const cityNavList = document.getElementById('city-nav-list');
        const mobileNavList = document.getElementById('mobile-nav-list');
        
        // ç”¨ä¾†è¿½è¹¤æ¯å€‹å€åŸŸç›®å‰é¡¯ç¤ºäº†å¤šå°‘è²¼æ–‡
        let currentPostCounts = {};

        /**
         * æ ¼å¼åŒ–æ—¥æœŸé¡¯ç¤º
         * @param {string} dateStr - æ—¥æœŸå­—ä¸² (æ ¼å¼ï¼š'YYYY-MM-DD')
         * @returns {string} æ ¼å¼åŒ–å¾Œçš„æ—¥æœŸå­—ä¸²
         */
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
        }

        /**
         * ç”Ÿæˆ IG åµŒå…¥è²¼æ–‡çš„ HTML
         * @param {Object} post - è²¼æ–‡è³‡æ–™ç‰©ä»¶ { region, permalink, date, content }
         * @returns {string} HTML å­—ä¸²
         */
        function createPostCard(post) {
            // æ¸…ç† permalinkï¼Œç§»é™¤æ‰€æœ‰æŸ¥è©¢åƒæ•¸ï¼Œåªä¿ç•™ä¹¾æ·¨çš„ URL
            // Instagram embed.js éœ€è¦ä¹¾æ·¨çš„ permalink æ‰èƒ½æ­£ç¢ºè­˜åˆ¥è²¼æ–‡
            let cleanPermalink = post.permalink.trim();
            
            // ç§»é™¤ URL ä¸­çš„æŸ¥è©¢åƒæ•¸ï¼ˆ? ä¹‹å¾Œçš„æ‰€æœ‰å…§å®¹ï¼‰
            if (cleanPermalink.includes('?')) {
                cleanPermalink = cleanPermalink.split('?')[0];
            }
            
            // ç§»é™¤ URL ä¸­çš„éŒ¨é»ï¼ˆ# ä¹‹å¾Œçš„æ‰€æœ‰å…§å®¹ï¼‰
            if (cleanPermalink.includes('#')) {
                cleanPermalink = cleanPermalink.split('#')[0];
            }
            
            // ç¢ºä¿ URL ä»¥æ–œç·šçµå°¾ï¼ˆInstagram çš„æ¨™æº–æ ¼å¼ï¼‰
            if (!cleanPermalink.endsWith('/')) {
                cleanPermalink += '/';
            }
            
            // ç¢ºä¿ URL æ ¼å¼æ­£ç¢ºï¼ˆå¿…é ˆåŒ…å« instagram.comï¼‰
            if (!cleanPermalink.includes('instagram.com')) {
                console.error('Invalid Instagram permalink:', post.permalink);
            }
            
            return `
                <div class="post-card rounded-xl shadow-md bg-white overflow-hidden">
                    <!-- IG åµŒå…¥è²¼æ–‡å®¹å™¨ -->
                    <div class="w-full ig-embed-container">
                        <blockquote class="instagram-media" data-instgrm-permalink="${cleanPermalink}" data-instgrm-version="14"></blockquote>
                    </div>
                    
                    <!-- æ‰‹å‹•æ·»åŠ  IG é€£çµæŒ‰éˆ•ï¼Œç¢ºä¿é»æ“Šæ™‚æ‰“é–‹æ­£ç¢ºçš„è²¼æ–‡ -->
                    <div class="px-4 pb-2">
                        <a href="${cleanPermalink}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-xs text-slate-500 hover:text-blue-600 transition duration-150">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                            </svg>
                            åœ¨ Instagram æŸ¥çœ‹é€™å‰‡è²¼æ–‡
                        </a>
                    </div>
                    
                    <!-- è²¼æ–‡è³‡è¨Š -->
                    <div class="p-4">
                        <!-- è²¼æ–‡å…§å®¹ -->
                        <p class="text-slate-700 text-sm mb-3 leading-relaxed">${post.content}</p>
                        
                        <!-- åœ°åœ–æŒ‰éˆ•ï¼ˆå¦‚æœæœ‰åœ°åœ–é€£çµï¼‰ -->
                        ${post.map ? `
                        <div class="mb-3">
                            <a href="${post.map}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-sm font-medium text-blue-600 hover:text-blue-700 transition duration-150">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0l-4.243-4.243a8 8 0 1111.314 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                                é–‹å•Ÿåœ°åœ–
                            </a>
                        </div>
                        ` : ''}
                        
                        <!-- åº•éƒ¨è³‡è¨Šï¼šæ—¥æœŸå’Œå€åŸŸæ¨™ç±¤ -->
                        <div class="flex justify-between items-center">
                            <span class="text-xs text-slate-500">${formatDate(post.date)}</span>
                            <span class="inline-block text-xs font-semibold text-white bg-blue-600 px-3 py-1 rounded-full">${post.region}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * ä¿®æ­£ Instagram embed ä¸­çš„é€£çµï¼Œç¢ºä¿æŒ‡å‘æ­£ç¢ºçš„ permalink
         */
        function fixInstagramLinks() {
            // æ‰¾åˆ°æ‰€æœ‰ Instagram embed çš„ blockquote
            const instagramEmbeds = document.querySelectorAll('blockquote.instagram-media');
            
            instagramEmbeds.forEach(blockquote => {
                const permalink = blockquote.getAttribute('data-instgrm-permalink');
                if (!permalink) return;
                
                // æ¸…ç† permalink
                let cleanPermalink = permalink.trim();
                if (cleanPermalink.includes('?')) {
                    cleanPermalink = cleanPermalink.split('?')[0];
                }
                if (cleanPermalink.includes('#')) {
                    cleanPermalink = cleanPermalink.split('#')[0];
                }
                if (!cleanPermalink.endsWith('/')) {
                    cleanPermalink += '/';
                }
                
                // æ›´æ–° blockquote ä¸­çš„ permalink
                blockquote.setAttribute('data-instgrm-permalink', cleanPermalink);
                
                // æ‰¾åˆ° blockquote å…§çš„æ‰€æœ‰é€£çµä¸¦æ›´æ–°
                const links = blockquote.querySelectorAll('a[href*="instagram.com"]');
                links.forEach(link => {
                    // åªæ›´æ–°æŒ‡å‘ Instagram çš„é€£çµ
                    if (link.href.includes('instagram.com')) {
                        link.href = cleanPermalink;
                        link.setAttribute('target', '_blank');
                        link.setAttribute('rel', 'noopener noreferrer');
                    }
                });
            });
        }

        /**
         * æ¸²æŸ“æŒ‡å®šå€åŸŸçš„ IG è²¼æ–‡
         * @param {Array} posts - è¦æ¸²æŸ“çš„è²¼æ–‡é™£åˆ—
         * @param {HTMLElement} gridContainer - è²¼æ–‡ç¶²æ ¼å®¹å™¨
         * @param {number} start - é–‹å§‹ç´¢å¼•
         * @param {number} count - è¦æ¸²æŸ“çš„æ•¸é‡
         */
        function appendPosts(posts, gridContainer, start, count) {
            const end = Math.min(start + count, posts.length);
            for (let i = start; i < end; i++) {
                gridContainer.insertAdjacentHTML('beforeend', createPostCard(posts[i]));
            }
            // è§¸ç™¼ Instagram embed.js é‡æ–°è™•ç†åµŒå…¥å…§å®¹
            if (window.instgrm) {
                window.instgrm.Embeds.process();
                // ç­‰å¾… embed.js è™•ç†å®Œæˆå¾Œï¼Œä¿®æ­£é€£çµ
                setTimeout(() => {
                    fixInstagramLinks();
                }, 500);
            }
        }

        /**
         * è™•ç†é»æ“Šã€Œè¼‰å…¥æ›´å¤šã€æŒ‰éˆ•çš„é‚è¼¯
         * @param {string} city - åŸå¸‚åç¨±
         */
        window.loadMore = function(city) {
            // å–å¾—è©²å€åŸŸçš„æ‰€æœ‰è²¼æ–‡
            const cityPosts = IG_POSTS.filter(post => post.region === city);
            const currentCount = currentPostCounts[city] || 0;
            const gridContainer = document.getElementById(`grid-${city.replace(/\s/g, '-')}`);
            const loadMoreButton = document.getElementById(`load-more-${city.replace(/\s/g, '-')}`);

            if (!gridContainer || !loadMoreButton) return;

            // æ·»åŠ æ›´å¤š IG è²¼æ–‡
            appendPosts(cityPosts, gridContainer, currentCount, POSTS_PER_LOAD);
            currentPostCounts[city] = Math.min(currentCount + POSTS_PER_LOAD, cityPosts.length);

            // æ›´æ–°æŒ‰éˆ•æ–‡å­—
            const total = cityPosts.length;
            const current = currentPostCounts[city];
            loadMoreButton.textContent = `è¼‰å…¥æ›´å¤š (ç›®å‰å·²é¡¯ç¤º ${current} / ${total} ç¯‡)`;

            // æª¢æŸ¥æ˜¯å¦é‚„æœ‰æ›´å¤šè²¼æ–‡å¯ä»¥è¼‰å…¥
            if (current >= total) {
                loadMoreButton.textContent = `å·²é¡¯ç¤ºå…¨éƒ¨ ${total} ç¯‡è²¼æ–‡`;
                loadMoreButton.disabled = true;
                loadMoreButton.classList.remove('bg-blue', 'hover:bg-blue');
                loadMoreButton.classList.add('bg-gray-300', 'cursor-not-allowed');
            }
        };

        /**
         * å°‡è²¼æ–‡åˆ†çµ„ä¸¦æ¸²æŸ“åˆ°é é¢ä¸Š (æˆ–æ ¹æ“šæœå°‹çµæœæ¸²æŸ“)
         * @param {Array} regionsToRender - è¦æ¸²æŸ“çš„å€åŸŸé™£åˆ— (ä¾†è‡ª REGIONS æˆ– filterPosts)
         * @param {boolean} isSearchMode - æ˜¯å¦è™•æ–¼æœå°‹æ¨¡å¼
         */
        function renderPosts(regionsToRender, isSearchMode = false) {
            postsContainer.innerHTML = ''; // æ¸…ç©ºå®¹å™¨
            currentPostCounts = {}; // é‡ç½®è¨ˆæ•¸

            if (regionsToRender.length === 0 && document.getElementById('search-input').value.trim() !== '') {
                noResults.classList.remove('hidden');
                cityNavList.innerHTML = ''; // æœå°‹ç„¡æœï¼Œæ¸…ç©ºå´é‚Šæ¬„
                if (mobileNavList) {
                    mobileNavList.innerHTML = ''; // æœå°‹ç„¡æœï¼Œæ¸…ç©ºæ‰‹æ©Ÿç‰ˆå°èˆª
                }
                return;
            } else {
                noResults.classList.add('hidden');
            }

            // æŒ‰å€åŸŸåˆ†çµ„è²¼æ–‡ï¼Œä¸¦æŒ‰æ—¥æœŸæ–°åˆ°èˆŠæ’åº
            const sortedPosts = [...IG_POSTS].sort((a, b) => {
                // æŒ‰æ—¥æœŸæ–°åˆ°èˆŠæ’åº
                return new Date(b.date) - new Date(a.date);
            });
            
            const groupedPosts = sortedPosts.reduce((acc, post) => {
                const region = post.region;
                if (!acc[region]) {
                    acc[region] = [];
                }
                acc[region].push(post);
                return acc;
            }, {});

            // æ¸…ç©ºä¸¦é‡æ–°æ¸²æŸ“å´é‚Šå°èˆªï¼ˆæ¡Œé¢ç‰ˆå’Œæ‰‹æ©Ÿç‰ˆï¼‰
            cityNavList.innerHTML = '';
            if (mobileNavList) {
                mobileNavList.innerHTML = '';
            }

            // æ¸²æŸ“æ¯å€‹å€åŸŸå€å¡Š
            regionsToRender.forEach(city => {
                const cityPosts = groupedPosts[city] || [];

                // è½‰æ›ç‚ºå®‰å…¨çš„éŒ¨é» IDï¼šå°‡ç©ºæ ¼æ›¿æ›ç‚ºé€£å­—ç¬¦
                const safeCityId = city.replace(/\s+/g, '-'); // è½‰æ›ç‚ºéŒ¨é» ID
                const initialCount = isSearchMode ? cityPosts.length : Math.min(cityPosts.length, POSTS_PER_LOAD);
                const hasMore = cityPosts.length > initialCount;

                // æ¸²æŸ“æ¡Œé¢ç‰ˆå´é‚Šå°èˆªé …ç›®
                const navItem = document.createElement('li');
                navItem.innerHTML = `<a href="#${safeCityId}" class="block text-slate-600 hover:text-pink font-medium transition duration-150 p-1 rounded-lg">${city} ${cityPosts.length > 0 ? `(${cityPosts.length})` : ''}</a>`;
                cityNavList.appendChild(navItem);

                // æ¸²æŸ“æ‰‹æ©Ÿç‰ˆå°èˆªé …ç›®
                if (mobileNavList) {
                    const mobileNavItem = document.createElement('li');
                    mobileNavItem.className = 'flex-shrink-0';
                    mobileNavItem.innerHTML = `<a href="#${safeCityId}" class="inline-block text-sm text-slate-600 hover:text-pink font-medium transition duration-150 px-3 py-1.5 rounded-full bg-slate-50 hover:bg-pink-50 border border-slate-200 hover:border-pink-200 whitespace-nowrap">${city} ${cityPosts.length > 0 ? `(${cityPosts.length})` : ''}</a>`;
                    mobileNavList.appendChild(mobileNavItem);
                }

                // æ¸²æŸ“å€åŸŸå€å¡Š
                const citySection = document.createElement('section');
                citySection.id = safeCityId;
                citySection.className = 'city-section pt-10'; // å¢åŠ  pt-10 è®“éŒ¨é»ä¸æœƒè¢«å°èˆªæ¬„é®ä½
                citySection.innerHTML = `
                    <!-- å€åŸŸæ¨™é¡Œä½¿ç”¨ç²‰è‰²ä¸»é¡Œ -->
                    <h3 class="text-3xl font-extrabold text-pink mb-6 flex items-center border-b-2 border-pink pb-2">
                        <span class="mr-3 text-3xl">ğŸŒ¸</span> ${city} <span class="text-lg font-normal text-slate-500 ml-3">${cityPosts.length > 0 ? `(${cityPosts.length} ç¯‡)` : '(å°šç„¡è²¼æ–‡)'}</span>
                    </h3>
                    <!-- è²¼æ–‡ç¶²æ ¼å®¹å™¨ -->
                    <div id="grid-${safeCityId}" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6">
                        <!-- è²¼æ–‡å¡ç‰‡å°‡åœ¨é€™è£¡æ’å…¥ -->
                    </div>
                    <!-- è¼‰å…¥æ›´å¤šæŒ‰éˆ• -->
                    <div class="text-center mt-8">
                        ${cityPosts.length > 0 ? `
                        <button 
                            id="load-more-${safeCityId}" 
                            onclick="loadMore('${city}')" 
                            class="font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 
                                ${!hasMore ? 'bg-gray-300 cursor-not-allowed' : 'bg-blue hover:bg-blue text-white'}"
                            ${!hasMore ? 'disabled' : ''}
                        >
                            ${hasMore ? `è¼‰å…¥æ›´å¤š (ç›®å‰å·²é¡¯ç¤º ${initialCount} / ${cityPosts.length} ç¯‡)` : `å·²é¡¯ç¤ºå…¨éƒ¨ ${cityPosts.length} ç¯‡è²¼æ–‡`}
                        </button>
                        ` : ''}
                    </div>
                `;
                
                const gridContainer = citySection.querySelector('.grid');
                // æ¸²æŸ“åˆå§‹ IG è²¼æ–‡
                if (cityPosts.length > 0) {
                    appendPosts(cityPosts, gridContainer, 0, initialCount);
                    currentPostCounts[city] = initialCount;
                }

                postsContainer.appendChild(citySection);
            });

            // è§¸ç™¼ Instagram embed.js è™•ç†åµŒå…¥å…§å®¹
            if (window.instgrm) {
                window.instgrm.Embeds.process();
                // ç­‰å¾… embed.js è™•ç†å®Œæˆå¾Œï¼Œä¿®æ­£é€£çµ
                setTimeout(() => {
                    fixInstagramLinks();
                }, 500);
            }
        }

        /**
         * æ ¹æ“šæœå°‹é—œéµå­—éæ¿¾å€åŸŸå’Œè²¼æ–‡
         * @param {string} query - æœå°‹é—œéµå­—
         */
        function filterPosts(query) {
            const normalizedQuery = query.trim().toLowerCase();
            searchQueryDisplay.textContent = query.trim();

            if (normalizedQuery === '') {
                renderPosts(REGIONS); // æœå°‹æ¬„æ¸…ç©ºæ™‚ï¼Œé¡¯ç¤ºæ‰€æœ‰å€åŸŸ
                return;
            }

            // éæ¿¾é‚è¼¯ï¼šæª¢æŸ¥å€åŸŸåç¨±æˆ–è²¼æ–‡å…§å®¹æ˜¯å¦åŒ…å«é—œéµå­—
            const matchingRegions = new Set();
            
            // æª¢æŸ¥å€åŸŸåç¨±
            REGIONS.forEach(region => {
                if (region.toLowerCase().includes(normalizedQuery)) {
                    matchingRegions.add(region);
                }
            });
            
            // æª¢æŸ¥è²¼æ–‡å…§å®¹å’Œå€åŸŸ
            IG_POSTS.forEach(post => {
                if (post.region.toLowerCase().includes(normalizedQuery) ||
                    (post.content && post.content.toLowerCase().includes(normalizedQuery))) {
                    matchingRegions.add(post.region);
                }
            });

            const filtered = Array.from(matchingRegions);

            // æœå°‹æ¨¡å¼ä¸‹ï¼Œä¸€æ¬¡æ€§é¡¯ç¤ºæ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„çµæœ
            renderPosts(filtered, true); 
        }

        // é é¢è¼‰å…¥æ™‚ï¼Œå…ˆæ¸²æŸ“æ‰€æœ‰å€åŸŸ
        document.addEventListener('DOMContentLoaded', () => {
            renderPosts(REGIONS);
            
            // ç›£è½ Instagram embed.js çš„è¼‰å…¥
            if (window.instgrm) {
                // å¦‚æœå·²ç¶“è¼‰å…¥ï¼Œç«‹å³ä¿®æ­£é€£çµ
                setTimeout(() => {
                    fixInstagramLinks();
                }, 1000);
            } else {
                // å¦‚æœé‚„æ²’è¼‰å…¥ï¼Œç›£è½è¼‰å…¥äº‹ä»¶
                window.addEventListener('load', () => {
                    setTimeout(() => {
                        fixInstagramLinks();
                    }, 1000);
                });
            }
            
            // ä½¿ç”¨ MutationObserver ç›£è½æ–°çš„ Instagram embed è¢«æ·»åŠ 
            const observer = new MutationObserver((mutations) => {
                let shouldFix = false;
                mutations.forEach((mutation) => {
                    mutation.addedNodes.forEach((node) => {
                        if (node.nodeType === 1) { // Element node
                            if (node.classList && node.classList.contains('instagram-media')) {
                                shouldFix = true;
                            } else if (node.querySelector && node.querySelector('.instagram-media')) {
                                shouldFix = true;
                            }
                        }
                    });
                });
                if (shouldFix) {
                    setTimeout(() => {
                        fixInstagramLinks();
                    }, 500);
                }
            });
            
            // é–‹å§‹è§€å¯Ÿæ•´å€‹æ–‡æª”çš„è®ŠåŒ–
            observer.observe(document.body, {
                childList: true,
                subtree: true
            });

            // è™•ç†å°èˆªé»æ“Šå¹³æ»‘æ²å‹•çš„å…±ç”¨å‡½æ•¸
            let isScrolling = false; // é˜²æ­¢é‡è¤‡é»æ“Šé€ æˆå¤šæ¬¡æ²å‹•
            
            function handleNavClick(e) {
                // æ‰¾åˆ°è¢«é»æ“Šçš„ <a> æ¨™ç±¤ï¼ˆå¯èƒ½æ˜¯é»æ“Šåˆ° <a> å…§çš„æ–‡å­—ï¼‰
                const linkElement = e.target.closest('a');
                if (!linkElement) return;
                
                e.preventDefault();
                e.stopPropagation();
                
                // å¦‚æœæ­£åœ¨æ²å‹•ï¼Œå¿½ç•¥æ–°çš„é»æ“Š
                if (isScrolling) {
                    return;
                }
                
                const href = linkElement.getAttribute('href');
                if (!href || !href.startsWith('#')) return;
                
                const targetId = href.substring(1);
                const targetElement = document.getElementById(targetId);
                
                if (!targetElement) {
                    console.warn('æ‰¾ä¸åˆ°ç›®æ¨™å…ƒç´ :', targetId);
                    return;
                }
                
                isScrolling = true;
                
                // è¨ˆç®—ç›®æ¨™ä½ç½®ï¼ˆè€ƒæ…® sticky header çš„é«˜åº¦ï¼Œæ‰‹æ©Ÿç‰ˆéœ€è¦æ›´å¤§çš„åç§»ï¼‰
                const isMobile = window.innerWidth < 1024; // lg æ–·é»
                const headerOffset = isMobile ? 180 : 120; // æ‰‹æ©Ÿç‰ˆ header è¼ƒé«˜ï¼ˆåŒ…å«åˆ†é¡å°è¦½ï¼‰
                const elementPosition = targetElement.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                
                // ä½¿ç”¨ window.scrollTo é€²è¡Œå¹³æ»‘æ²å‹•
                window.scrollTo({
                    top: Math.max(0, offsetPosition), // ç¢ºä¿ä¸æœƒæ²å‹•åˆ°è² æ•¸ä½ç½®
                    behavior: 'smooth'
                });
                
                // æ²å‹•å®Œæˆå¾Œé‡ç½®æ¨™è¨˜
                setTimeout(() => {
                    isScrolling = false;
                }, 1000); // å¢åŠ æ™‚é–“ä»¥ç¢ºä¿æ²å‹•å®Œæˆ
            }
            
            // ç‚ºæ¡Œé¢ç‰ˆå´é‚Šæ¬„æ·»åŠ é»æ“Šäº‹ä»¶
            cityNavList.addEventListener('click', handleNavClick);
            
            // ç‚ºæ‰‹æ©Ÿç‰ˆå°èˆªæ·»åŠ é»æ“Šäº‹ä»¶
            if (mobileNavList) {
                mobileNavList.addEventListener('click', handleNavClick);
            }
        });
    </script>

</body>
</html>
